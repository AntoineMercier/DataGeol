--
-- PostgreSQL database dump
--

-- Dumped from database version 13.0
-- Dumped by pg_dump version 13.1

-- Started on 2021-03-02 16:43:00

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

--
-- TOC entry 2 (class 3079 OID 16395)
-- Name: postgis; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS postgis WITH SCHEMA public;


--
-- TOC entry 4052 (class 0 OID 0)
-- Dependencies: 2
-- Name: EXTENSION postgis; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION postgis IS 'PostGIS geometry, geography, and raster spatial types and functions';


--
-- TOC entry 1390 (class 1247 OID 34019)
-- Name: year; Type: DOMAIN; Schema: public; Owner: postgres
--

CREATE DOMAIN public.year AS integer
	CONSTRAINT year_check CHECK (((VALUE >= 1901) AND (VALUE <= 2155)));


ALTER DOMAIN public.year OWNER TO postgres;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- TOC entry 228 (class 1259 OID 44750)
-- Name: geologists; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.geologists (
    id_geologists character varying NOT NULL,
    name character varying NOT NULL
);


ALTER TABLE public.geologists OWNER TO postgres;

--
-- TOC entry 208 (class 1259 OID 41099)
-- Name: lexicon_lines; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.lexicon_lines (
    label character varying NOT NULL,
    description text NOT NULL
);


ALTER TABLE public.lexicon_lines OWNER TO postgres;

--
-- TOC entry 207 (class 1259 OID 41091)
-- Name: lexicon_planes; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.lexicon_planes (
    label character varying NOT NULL,
    description text NOT NULL
);


ALTER TABLE public.lexicon_planes OWNER TO postgres;

--
-- TOC entry 4053 (class 0 OID 0)
-- Dependencies: 207
-- Name: TABLE lexicon_planes; Type: COMMENT; Schema: public; Owner: postgres
--

COMMENT ON TABLE public.lexicon_planes IS 'This table describes the different types of planes used to describe a geological structure.';


--
-- TOC entry 213 (class 1259 OID 42349)
-- Name: lexicon_sens_criteria; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.lexicon_sens_criteria (
    label character varying NOT NULL,
    description text NOT NULL
);


ALTER TABLE public.lexicon_sens_criteria OWNER TO postgres;

--
-- TOC entry 220 (class 1259 OID 43989)
-- Name: measures_id_measure_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.measures_id_measure_seq
    START WITH 0
    INCREMENT BY 1
    MINVALUE 0
    MAXVALUE 2147483647
    CACHE 1;


ALTER TABLE public.measures_id_measure_seq OWNER TO postgres;

--
-- TOC entry 224 (class 1259 OID 44398)
-- Name: measures; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.measures (
    id_measure integer DEFAULT nextval('public.measures_id_measure_seq'::regclass) NOT NULL,
    station character varying NOT NULL,
    formation character varying,
    plane_type character varying NOT NULL,
    plane_polarity character varying,
    plane_comment text,
    plane_dir_hook smallint,
    plane_azimuth smallint,
    plane_dip smallint,
    plane_dip_quad character varying,
    line_type character varying,
    line_comment text,
    line_pitch smallint,
    line_pitch_quad character varying,
    line_strike smallint,
    line_dip smallint,
    sens_criteria character varying,
    sens character varying,
    geologist character varying,
    used_geomodeller character varying,
    structure_measured character varying
);


ALTER TABLE public.measures OWNER TO postgres;

--
-- TOC entry 225 (class 1259 OID 44466)
-- Name: stations; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.stations (
    id_station character varying NOT NULL,
    lon_x real NOT NULL,
    lat_y real NOT NULL,
    elevation_baro smallint,
    elevation_gps smallint,
    "time" timestamp without time zone,
    position_source character varying,
    place text,
    mission character varying,
    outcrop_type character varying DEFAULT 'outcrop'::character varying NOT NULL,
    outcrop_facies text,
    geol_map character varying,
    geol_map_formation character varying,
    comment text,
    field_notebook character varying,
    pages smallint,
    location public.geography GENERATED ALWAYS AS (public.st_setsrid(public.st_makepoint((lon_x)::double precision, (lat_y)::double precision), 4326)) STORED
);


ALTER TABLE public.stations OWNER TO postgres;

--
-- TOC entry 4054 (class 0 OID 0)
-- Dependencies: 225
-- Name: COLUMN stations.elevation_gps; Type: COMMENT; Schema: public; Owner: postgres
--

COMMENT ON COLUMN public.stations.elevation_gps IS 'This column specify the elevation of the station above sea level, measured by GNSS positionning';


--
-- TOC entry 233 (class 1259 OID 61139)
-- Name: VIEW_Measures; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public."VIEW_Measures" AS
 SELECT measures.id_measure AS "NÂ° measure",
    stations.id_station AS "Station",
    measures.formation,
    stations.mission,
    lexicon_planes.description AS "Plane type",
    measures.plane_comment AS "Comment on plane",
        CASE
            WHEN (measures.plane_dip IS NOT NULL) THEN measures.plane_dip
            WHEN ((measures.plane_dip < 0) OR (measures.plane_dip > 90)) THEN NULL::smallint
            WHEN (measures.plane_dip IS NULL) THEN NULL::smallint
            ELSE NULL::smallint
        END AS "Plane dip",
        CASE
            WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
            WHEN (measures.plane_dir_hook IS NOT NULL) THEN (measures.plane_dir_hook)::integer
            WHEN (
            CASE
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                WHEN (measures.plane_dip = 0) THEN 0
                ELSE NULL::integer
            END = 0) THEN 90
            WHEN (
            CASE
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                WHEN (measures.plane_dip = 0) THEN 0
                ELSE NULL::integer
            END < 270) THEN (
            CASE
                WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                WHEN (measures.plane_dip = 0) THEN 0
                ELSE NULL::integer
            END + 90)
            WHEN (
            CASE
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                WHEN (measures.plane_dip = 0) THEN 0
                ELSE NULL::integer
            END > 270) THEN ((
            CASE
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                WHEN (measures.plane_dip = 0) THEN 0
                ELSE NULL::integer
            END + 90) - 360)
            WHEN (
            CASE
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                WHEN (measures.plane_dip = 0) THEN 0
                ELSE NULL::integer
            END = 270) THEN 0
            ELSE NULL::integer
        END AS "Plane dip-direction",
    lexicon_lines.description AS "Line type",
    measures.line_comment AS "Comment on line",
    round(
        CASE
            WHEN ((360 < measures.line_strike) OR (0 > measures.line_strike)) THEN NULL::double precision
            WHEN (measures.line_strike IS NOT NULL) THEN (measures.line_strike)::double precision
            WHEN (
            CASE
                WHEN ((measures.line_pitch IS NULL) AND (measures.line_strike IS NULL)) THEN NULL::integer
                WHEN (measures.line_pitch = 0) THEN (measures.line_pitch)::integer
                WHEN (measures.line_pitch = 90) THEN (measures.line_pitch)::integer
                WHEN (((
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                WHEN (((
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                WHEN ((0 <= (
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90)) AND ((
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (measures.line_pitch)::integer
                WHEN ((0 <= (
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90)) AND ((
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (180 - measures.line_pitch)
                WHEN ((90 <= (
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90)) AND ((
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (measures.line_pitch)::integer
                WHEN ((90 <= (
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90)) AND ((
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (180 - measures.line_pitch)
                WHEN ((180 <= (
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90)) AND ((
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                WHEN ((180 <= (
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90)) AND ((
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                WHEN ((270 <= (
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90)) AND ((
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (measures.line_pitch)::integer
                WHEN ((270 <= (
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90)) AND ((
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (180 - measures.line_pitch)
                ELSE NULL::integer
            END IS NULL) THEN NULL::double precision
            WHEN (
            CASE
                WHEN (
                CASE
                    WHEN ((measures.line_pitch IS NULL) AND (measures.line_strike IS NULL)) THEN NULL::integer
                    WHEN (measures.line_pitch = 0) THEN (measures.line_pitch)::integer
                    WHEN (measures.line_pitch = 90) THEN (measures.line_pitch)::integer
                    WHEN (((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                    WHEN (((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((0 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((0 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((90 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((90 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((180 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((180 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((270 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((270 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (180 - measures.line_pitch)
                    ELSE NULL::integer
                END < 90) THEN ((
                CASE
                    WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                    WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                    WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                    WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                    WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                    WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                    WHEN (measures.plane_dip = 0) THEN 0
                    ELSE NULL::integer
                END)::double precision + abs(degrees(atan((cos((((measures.plane_dip)::double precision * pi()) / (180)::double precision)) * tan((((
                CASE
                    WHEN ((measures.line_pitch IS NULL) AND (measures.line_strike IS NULL)) THEN NULL::integer
                    WHEN (measures.line_pitch = 0) THEN (measures.line_pitch)::integer
                    WHEN (measures.line_pitch = 90) THEN (measures.line_pitch)::integer
                    WHEN (((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                    WHEN (((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((0 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((0 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((90 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((90 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((180 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((180 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((270 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((270 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (180 - measures.line_pitch)
                    ELSE NULL::integer
                END)::double precision * pi()) / (180)::double precision)))))))
                ELSE ((
                CASE
                    WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                    WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                    WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                    WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                    WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                    WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                    WHEN (measures.plane_dip = 0) THEN 0
                    ELSE NULL::integer
                END)::double precision + ((180)::double precision - abs(degrees(atan((cos((((measures.plane_dip)::double precision * pi()) / (180)::double precision)) * tan((((
                CASE
                    WHEN ((measures.line_pitch IS NULL) AND (measures.line_strike IS NULL)) THEN NULL::integer
                    WHEN (measures.line_pitch = 0) THEN (measures.line_pitch)::integer
                    WHEN (measures.line_pitch = 90) THEN (measures.line_pitch)::integer
                    WHEN (((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                    WHEN (((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((0 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((0 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((90 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((90 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((180 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((180 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((270 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((270 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (180 - measures.line_pitch)
                    ELSE NULL::integer
                END)::double precision * pi()) / (180)::double precision))))))))
            END > (360)::double precision) THEN (
            CASE
                WHEN (
                CASE
                    WHEN ((measures.line_pitch IS NULL) AND (measures.line_strike IS NULL)) THEN NULL::integer
                    WHEN (measures.line_pitch = 0) THEN (measures.line_pitch)::integer
                    WHEN (measures.line_pitch = 90) THEN (measures.line_pitch)::integer
                    WHEN (((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                    WHEN (((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((0 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((0 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((90 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((90 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((180 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((180 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((270 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((270 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (180 - measures.line_pitch)
                    ELSE NULL::integer
                END < 90) THEN ((
                CASE
                    WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                    WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                    WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                    WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                    WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                    WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                    WHEN (measures.plane_dip = 0) THEN 0
                    ELSE NULL::integer
                END)::double precision + abs(degrees(atan((cos((((measures.plane_dip)::double precision * pi()) / (180)::double precision)) * tan((((
                CASE
                    WHEN ((measures.line_pitch IS NULL) AND (measures.line_strike IS NULL)) THEN NULL::integer
                    WHEN (measures.line_pitch = 0) THEN (measures.line_pitch)::integer
                    WHEN (measures.line_pitch = 90) THEN (measures.line_pitch)::integer
                    WHEN (((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                    WHEN (((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((0 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((0 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((90 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((90 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((180 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((180 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((270 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((270 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (180 - measures.line_pitch)
                    ELSE NULL::integer
                END)::double precision * pi()) / (180)::double precision)))))))
                ELSE ((
                CASE
                    WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                    WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                    WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                    WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                    WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                    WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                    WHEN (measures.plane_dip = 0) THEN 0
                    ELSE NULL::integer
                END)::double precision + ((180)::double precision - abs(degrees(atan((cos((((measures.plane_dip)::double precision * pi()) / (180)::double precision)) * tan((((
                CASE
                    WHEN ((measures.line_pitch IS NULL) AND (measures.line_strike IS NULL)) THEN NULL::integer
                    WHEN (measures.line_pitch = 0) THEN (measures.line_pitch)::integer
                    WHEN (measures.line_pitch = 90) THEN (measures.line_pitch)::integer
                    WHEN (((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                    WHEN (((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((0 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((0 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((90 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((90 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((180 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((180 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((270 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((270 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (180 - measures.line_pitch)
                    ELSE NULL::integer
                END)::double precision * pi()) / (180)::double precision))))))))
            END - (360)::double precision)
            ELSE
            CASE
                WHEN (
                CASE
                    WHEN ((measures.line_pitch IS NULL) AND (measures.line_strike IS NULL)) THEN NULL::integer
                    WHEN (measures.line_pitch = 0) THEN (measures.line_pitch)::integer
                    WHEN (measures.line_pitch = 90) THEN (measures.line_pitch)::integer
                    WHEN (((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                    WHEN (((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((0 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((0 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((90 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((90 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((180 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((180 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((270 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((270 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (180 - measures.line_pitch)
                    ELSE NULL::integer
                END < 90) THEN ((
                CASE
                    WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                    WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                    WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                    WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                    WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                    WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                    WHEN (measures.plane_dip = 0) THEN 0
                    ELSE NULL::integer
                END)::double precision + abs(degrees(atan((cos((((measures.plane_dip)::double precision * pi()) / (180)::double precision)) * tan((((
                CASE
                    WHEN ((measures.line_pitch IS NULL) AND (measures.line_strike IS NULL)) THEN NULL::integer
                    WHEN (measures.line_pitch = 0) THEN (measures.line_pitch)::integer
                    WHEN (measures.line_pitch = 90) THEN (measures.line_pitch)::integer
                    WHEN (((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                    WHEN (((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((0 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((0 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((90 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((90 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((180 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((180 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((270 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((270 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (180 - measures.line_pitch)
                    ELSE NULL::integer
                END)::double precision * pi()) / (180)::double precision)))))))
                ELSE ((
                CASE
                    WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                    WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                    WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                    WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                    WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                    WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                    WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                    WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                    WHEN (measures.plane_dip = 0) THEN 0
                    ELSE NULL::integer
                END)::double precision + ((180)::double precision - abs(degrees(atan((cos((((measures.plane_dip)::double precision * pi()) / (180)::double precision)) * tan((((
                CASE
                    WHEN ((measures.line_pitch IS NULL) AND (measures.line_strike IS NULL)) THEN NULL::integer
                    WHEN (measures.line_pitch = 0) THEN (measures.line_pitch)::integer
                    WHEN (measures.line_pitch = 90) THEN (measures.line_pitch)::integer
                    WHEN (((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                    WHEN (((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((0 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((0 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((90 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((90 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((180 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((180 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                    WHEN ((270 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (measures.line_pitch)::integer
                    WHEN ((270 <= (
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90)) AND ((
                    CASE
                        WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 0) THEN 90
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END < 270) THEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END > 270) THEN ((
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END + 90) - 360)
                        WHEN (
                        CASE
                            WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                            WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                            WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                            WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                            WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                            WHEN (measures.plane_dip = 0) THEN 0
                            ELSE NULL::integer
                        END = 270) THEN 0
                        ELSE NULL::integer
                    END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (180 - measures.line_pitch)
                    ELSE NULL::integer
                END)::double precision * pi()) / (180)::double precision))))))))
            END
        END) AS "Line strike",
    round(
        CASE
            WHEN (measures.line_dip IS NOT NULL) THEN (measures.line_dip)::double precision
            WHEN ((360 < measures.line_strike) OR (0 > measures.line_strike)) THEN NULL::double precision
            WHEN (measures.line_strike IS NOT NULL) THEN abs(degrees(atan((sin((((
            CASE
                WHEN ((measures.line_strike - (
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (measures.plane_dir_hook IS NOT NULL) THEN (measures.plane_dir_hook)::integer
                    WHEN (
                    CASE
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90)) < 0) THEN ((measures.line_strike + 180) - (
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (measures.plane_dir_hook IS NOT NULL) THEN (measures.plane_dir_hook)::integer
                    WHEN (
                    CASE
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90))
                ELSE (measures.line_strike - (
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (measures.plane_dir_hook IS NOT NULL) THEN (measures.plane_dir_hook)::integer
                    WHEN (
                    CASE
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90))
            END)::double precision * pi()) / (180)::double precision)) * tan((((measures.plane_dip)::double precision * pi()) / (180)::double precision))))))
            ELSE degrees(asin((sin((((measures.plane_dip)::double precision * pi()) / (180)::double precision)) * sin((((
            CASE
                WHEN ((measures.line_pitch IS NULL) AND (measures.line_strike IS NULL)) THEN NULL::integer
                WHEN (measures.line_pitch = 0) THEN (measures.line_pitch)::integer
                WHEN (measures.line_pitch = 90) THEN (measures.line_pitch)::integer
                WHEN (((
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                WHEN (((
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90) < 0) AND (((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                WHEN ((0 <= (
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90)) AND ((
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (measures.line_pitch)::integer
                WHEN ((0 <= (
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90)) AND ((
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90) < 90) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (180 - measures.line_pitch)
                WHEN ((90 <= (
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90)) AND ((
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (measures.line_pitch)::integer
                WHEN ((90 <= (
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90)) AND ((
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90) < 180) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (180 - measures.line_pitch)
                WHEN ((180 <= (
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90)) AND ((
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'S'::text) OR ((measures.line_pitch_quad)::text = 'SW'::text) OR ((measures.line_pitch_quad)::text = 'W'::text))) THEN (measures.line_pitch)::integer
                WHEN ((180 <= (
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90)) AND ((
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90) < 270) AND (((measures.line_pitch_quad)::text = 'N'::text) OR ((measures.line_pitch_quad)::text = 'NE'::text) OR ((measures.line_pitch_quad)::text = 'E'::text))) THEN (180 - measures.line_pitch)
                WHEN ((270 <= (
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90)) AND ((
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'W'::text) OR ((measures.line_pitch_quad)::text = 'NW'::text) OR ((measures.line_pitch_quad)::text = 'N'::text))) THEN (measures.line_pitch)::integer
                WHEN ((270 <= (
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90)) AND ((
                CASE
                    WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 0) THEN 90
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END < 270) THEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END > 270) THEN ((
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END + 90) - 360)
                    WHEN (
                    CASE
                        WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                        WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                        WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                        WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                        WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                        WHEN (measures.plane_dip = 0) THEN 0
                        ELSE NULL::integer
                    END = 270) THEN 0
                    ELSE NULL::integer
                END - 90) < 360) AND (((measures.line_pitch_quad)::text = 'E'::text) OR ((measures.line_pitch_quad)::text = 'SE'::text) OR ((measures.line_pitch_quad)::text = 'S'::text))) THEN (180 - measures.line_pitch)
                ELSE NULL::integer
            END)::double precision * pi()) / (180)::double precision)))))
        END) AS "Line dip",
    lexicon_sens_criteria.description AS "Sens criteria",
    geologists.name AS "Geologist",
    measures.used_geomodeller AS "Used in GeoModeller",
    stations.location
   FROM (((((public.stations
     LEFT JOIN public.measures ON (((stations.id_station)::text = (measures.station)::text)))
     LEFT JOIN public.lexicon_planes ON (((measures.plane_type)::text = (lexicon_planes.label)::text)))
     LEFT JOIN public.lexicon_lines ON (((measures.line_type)::text = (lexicon_lines.label)::text)))
     LEFT JOIN public.lexicon_sens_criteria ON (((measures.sens_criteria)::text = (lexicon_sens_criteria.label)::text)))
     LEFT JOIN public.geologists ON (((measures.geologist)::text = (geologists.id_geologists)::text)))
  WHERE (measures.id_measure IS NOT NULL)
  ORDER BY stations.id_station;


ALTER TABLE public."VIEW_Measures" OWNER TO postgres;

--
-- TOC entry 214 (class 1259 OID 42357)
-- Name: lexicon_samples; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.lexicon_samples (
    label character varying NOT NULL,
    description text NOT NULL
);


ALTER TABLE public.lexicon_samples OWNER TO postgres;

--
-- TOC entry 222 (class 1259 OID 44096)
-- Name: samples; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.samples (
    id_sample character varying NOT NULL,
    station character varying NOT NULL,
    type character varying DEFAULT 'sample'::character varying NOT NULL,
    associated_measure_id integer,
    facies text,
    formation character varying,
    aims character varying,
    current_storage character varying DEFAULT 'Lithotheque observatoire de Lyon'::character varying,
    comment text
);


ALTER TABLE public.samples OWNER TO postgres;

--
-- TOC entry 229 (class 1259 OID 44770)
-- Name: VIEW_Samples; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public."VIEW_Samples" AS
 SELECT samples.id_sample AS "Sample",
    lexicon_samples.description AS "Type",
    stations.id_station AS "Station",
    stations.place AS "General place",
    stations.mission AS "Mission",
    samples.facies AS "Sample facies",
    lexicon_planes.description AS "Plane type",
        CASE
            WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::text
            WHEN (measures.plane_azimuth IS NOT NULL) THEN concat('N', measures.plane_azimuth, ' ; ', measures.plane_dip, ' ', measures.plane_dip_quad)
            WHEN (measures.plane_azimuth IS NULL) THEN concat(measures.plane_dir_hook, ' / ', measures.plane_dip)
            ELSE NULL::text
        END AS "Plane orientation",
    lexicon_lines.description AS "Line type",
        CASE
            WHEN ((measures.line_pitch IS NULL) AND (measures.line_strike IS NULL)) THEN NULL::text
            WHEN (measures.line_pitch IS NULL) THEN concat(measures.line_strike, ' / ', measures.line_dip)
            WHEN (measures.line_pitch IS NOT NULL) THEN concat('pitch ', measures.line_pitch, ' ', measures.line_pitch_quad)
            ELSE NULL::text
        END AS "Line orientation",
    stations.location
   FROM (((((public.stations
     LEFT JOIN public.samples ON (((stations.id_station)::text = (samples.station)::text)))
     LEFT JOIN public.measures ON ((samples.associated_measure_id = measures.id_measure)))
     LEFT JOIN public.lexicon_samples ON (((samples.type)::text = (lexicon_samples.label)::text)))
     LEFT JOIN public.lexicon_planes ON (((measures.plane_type)::text = (lexicon_planes.label)::text)))
     LEFT JOIN public.lexicon_lines ON (((measures.line_type)::text = (lexicon_lines.label)::text)))
  WHERE ((samples.station)::text = (stations.id_station)::text)
  ORDER BY samples.id_sample;


ALTER TABLE public."VIEW_Samples" OWNER TO postgres;

--
-- TOC entry 212 (class 1259 OID 42340)
-- Name: lexicon_outcrop; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.lexicon_outcrop (
    label character varying NOT NULL,
    description text NOT NULL
);


ALTER TABLE public.lexicon_outcrop OWNER TO postgres;

--
-- TOC entry 230 (class 1259 OID 44776)
-- Name: VIEW_Stations; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public."VIEW_Stations" WITH (security_barrier='true') AS
 SELECT stations.id_station AS "Station",
    stations.elevation_baro AS "Elevation barometer",
    stations.elevation_gps AS "Elevation GPS",
    stations."time" AS "Date",
    stations.position_source AS "Positionning source",
    stations.place AS "General place",
    stations.mission AS "Mission",
    lexicon_outcrop.description AS "Outcrop type",
    stations.outcrop_facies AS "Outcrop facies",
    stations.geol_map AS "Geological map",
    stations.geol_map_formation AS "Geological map formation",
    stations.field_notebook AS "Field notebook",
    stations.pages AS "Pages",
    stations.comment AS "Comment on station",
    stations.location
   FROM (public.stations
     LEFT JOIN public.lexicon_outcrop ON (((stations.outcrop_type)::text = (lexicon_outcrop.label)::text)));


ALTER TABLE public."VIEW_Stations" OWNER TO postgres;

--
-- TOC entry 216 (class 1259 OID 42381)
-- Name: lexicon_sections; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.lexicon_sections (
    label text NOT NULL,
    description text NOT NULL
);


ALTER TABLE public.lexicon_sections OWNER TO postgres;

--
-- TOC entry 223 (class 1259 OID 44134)
-- Name: sections_section_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.sections_section_id_seq
    START WITH 0
    INCREMENT BY 1
    MINVALUE 0
    MAXVALUE 2147483647
    CACHE 1;


ALTER TABLE public.sections_section_id_seq OWNER TO postgres;

--
-- TOC entry 226 (class 1259 OID 44646)
-- Name: sections; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.sections (
    id_section integer DEFAULT nextval('public.sections_section_id_seq'::regclass) NOT NULL,
    sample character varying NOT NULL,
    type character varying DEFAULT 'TS-poli'::character varying NOT NULL,
    orientation character varying,
    comment text
);


ALTER TABLE public.sections OWNER TO postgres;

--
-- TOC entry 231 (class 1259 OID 44781)
-- Name: VIEW_sections; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public."VIEW_sections" AS
 SELECT sections.id_section AS "NÂ° section",
    sections.sample AS "Sample",
    stations.id_station AS "Station",
    lexicon_samples.description AS "Sample type",
    lexicon_sections.description AS "Section type",
    sections.orientation AS "Orientation",
    stations.place AS "General place",
    samples.facies AS "Sample facies",
    lexicon_planes.description AS "Plane type",
        CASE
            WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::text
            WHEN (measures.plane_azimuth IS NOT NULL) THEN concat('N', measures.plane_azimuth, ' ; ', measures.plane_dip, ' ', measures.plane_dip_quad)
            WHEN (measures.plane_azimuth IS NULL) THEN concat(measures.plane_dir_hook, ' / ', measures.plane_dip)
            ELSE NULL::text
        END AS "Plane orientation",
    lexicon_lines.description AS "Line type",
        CASE
            WHEN ((measures.line_pitch IS NULL) AND (measures.line_strike IS NULL)) THEN NULL::text
            WHEN (measures.line_pitch IS NULL) THEN concat(measures.line_strike, ' / ', measures.line_dip)
            WHEN (measures.line_pitch IS NOT NULL) THEN concat('pitch ', measures.line_pitch, ' ', measures.line_pitch_quad)
            ELSE NULL::text
        END AS "Line orientation",
    stations.location
   FROM (((((((public.sections
     LEFT JOIN public.lexicon_sections ON (((sections.type)::text = lexicon_sections.label)))
     LEFT JOIN public.samples ON (((sections.sample)::text = (samples.id_sample)::text)))
     LEFT JOIN public.stations ON (((samples.station)::text = (stations.id_station)::text)))
     LEFT JOIN public.measures ON ((samples.associated_measure_id = measures.id_measure)))
     LEFT JOIN public.lexicon_samples ON (((samples.type)::text = (lexicon_samples.label)::text)))
     LEFT JOIN public.lexicon_planes ON (((measures.plane_type)::text = (lexicon_planes.label)::text)))
     LEFT JOIN public.lexicon_lines ON (((measures.line_type)::text = (lexicon_lines.label)::text)))
  ORDER BY sections.id_section;


ALTER TABLE public."VIEW_sections" OWNER TO postgres;

--
-- TOC entry 227 (class 1259 OID 44711)
-- Name: VIEW_stereonet_planes; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public."VIEW_stereonet_planes" AS
 SELECT measures.id_measure AS "No.",
    'P'::text AS type,
    measures.structure_measured AS "Structure",
    stations.lon_x AS "Longitude",
    stations.lat_y AS "Latitude",
    stations.elevation_gps AS "Elevation",
    stations."time" AS "Time",
    stations.id_station AS "Notes",
        CASE
            WHEN ((measures.plane_azimuth IS NULL) AND (measures.plane_dir_hook IS NULL)) THEN NULL::integer
            WHEN (measures.plane_dir_hook IS NOT NULL) THEN (measures.plane_dir_hook)::integer
            WHEN (
            CASE
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                WHEN (measures.plane_dip = 0) THEN 0
                ELSE NULL::integer
            END = 0) THEN 90
            WHEN (
            CASE
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                WHEN (measures.plane_dip = 0) THEN 0
                ELSE NULL::integer
            END < 270) THEN (
            CASE
                WHEN (measures.plane_azimuth IS NULL) THEN NULL::integer
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                WHEN (measures.plane_dip = 0) THEN 0
                ELSE NULL::integer
            END + 90)
            WHEN (
            CASE
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                WHEN (measures.plane_dip = 0) THEN 0
                ELSE NULL::integer
            END > 270) THEN ((
            CASE
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                WHEN (measures.plane_dip = 0) THEN 0
                ELSE NULL::integer
            END + 90) - 360)
            WHEN (
            CASE
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 0) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN 270
                WHEN ((measures.plane_azimuth = 90) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN 90
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN 0
                WHEN ((measures.plane_azimuth = 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN 180
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'N'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'NE'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'E'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'SE'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'S'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'SW'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth + 180)
                WHEN ((measures.plane_azimuth > 90) AND (measures.plane_azimuth < 180) AND ((measures.plane_dip_quad)::text = 'W'::text)) THEN (measures.plane_azimuth)::integer
                WHEN ((measures.plane_azimuth > 0) AND (measures.plane_azimuth < 90) AND ((measures.plane_dip_quad)::text = 'NW'::text)) THEN (measures.plane_azimuth + 180)
                WHEN (measures.plane_dip = 90) THEN (measures.plane_azimuth)::integer
                WHEN (measures.plane_dip = 0) THEN 0
                ELSE NULL::integer
            END = 270) THEN 0
            ELSE NULL::integer
        END AS "Trd/Strk",
        CASE
            WHEN (measures.plane_dip IS NOT NULL) THEN measures.plane_dip
            WHEN ((measures.plane_dip < 0) OR (measures.plane_dip > 90)) THEN NULL::smallint
            WHEN (measures.plane_dip IS NULL) THEN NULL::smallint
            ELSE NULL::smallint
        END AS "Plg/Dip"
   FROM (public.stations
     LEFT JOIN public.measures ON (((stations.id_station)::text = (measures.station)::text)))
  WHERE (measures.structure_measured IS NOT NULL)
  ORDER BY measures.structure_measured;


ALTER TABLE public."VIEW_stereonet_planes" OWNER TO postgres;

--
-- TOC entry 218 (class 1259 OID 42549)
-- Name: contacts; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.contacts (
    id_contact integer NOT NULL,
    station character varying NOT NULL,
    type character varying NOT NULL,
    formation character varying,
    used_geomodeller character varying,
    geologist text
);


ALTER TABLE public.contacts OWNER TO postgres;

--
-- TOC entry 217 (class 1259 OID 42547)
-- Name: contacts_id_contacts_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.contacts_id_contacts_seq
    AS integer
    START WITH 0
    INCREMENT BY 1
    MINVALUE 0
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.contacts_id_contacts_seq OWNER TO postgres;

--
-- TOC entry 4055 (class 0 OID 0)
-- Dependencies: 217
-- Name: contacts_id_contacts_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.contacts_id_contacts_seq OWNED BY public.contacts.id_contact;


--
-- TOC entry 211 (class 1259 OID 41368)
-- Name: datations_bibliography; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.datations_bibliography (
    id integer NOT NULL,
    bibliographic_source character varying NOT NULL,
    sample_id character varying NOT NULL,
    location public.geography(Point,4326),
    elevation smallint,
    comment_location character varying,
    overall_structure character varying,
    facies character varying,
    structural_context character varying,
    mineral character varying,
    method character varying,
    method_precision character varying,
    age_precision character varying,
    age_author real NOT NULL,
    incertitude real,
    "2_sigma" real,
    age_interpreted real,
    "2_sigma_interpreted" real
);


ALTER TABLE public.datations_bibliography OWNER TO postgres;

--
-- TOC entry 232 (class 1259 OID 44891)
-- Name: fluid_inclusions; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.fluid_inclusions (
    id_analysis smallint NOT NULL,
    sample character varying NOT NULL,
    station character varying NOT NULL,
    "delta_D" smallint,
    "delta_18_O" smallint,
    microthermometry real
);


ALTER TABLE public.fluid_inclusions OWNER TO postgres;

--
-- TOC entry 210 (class 1259 OID 41163)
-- Name: formations; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.formations (
    serie character varying NOT NULL,
    id_formations character varying NOT NULL,
    description character varying
);


ALTER TABLE public.formations OWNER TO postgres;

--
-- TOC entry 4056 (class 0 OID 0)
-- Dependencies: 210
-- Name: TABLE formations; Type: COMMENT; Schema: public; Owner: postgres
--

COMMENT ON TABLE public.formations IS 'This tables describes the formations that will be used in the GeoModeller';


--
-- TOC entry 215 (class 1259 OID 42365)
-- Name: lexicon_contacts; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.lexicon_contacts (
    label character varying NOT NULL,
    description text NOT NULL
);


ALTER TABLE public.lexicon_contacts OWNER TO postgres;

--
-- TOC entry 219 (class 1259 OID 43636)
-- Name: maps; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.maps (
    id_map character varying NOT NULL,
    name character varying NOT NULL,
    type character varying NOT NULL,
    year public.year,
    scale character varying,
    authors text
);


ALTER TABLE public.maps OWNER TO postgres;

--
-- TOC entry 209 (class 1259 OID 41123)
-- Name: missions; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.missions (
    mission character varying NOT NULL,
    name text NOT NULL,
    region text NOT NULL,
    year public.year,
    participants text,
    project character varying
);


ALTER TABLE public.missions OWNER TO postgres;

--
-- TOC entry 206 (class 1259 OID 34023)
-- Name: natural_integers_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.natural_integers_seq
    START WITH 0
    INCREMENT BY 1
    MINVALUE 0
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.natural_integers_seq OWNER TO postgres;

--
-- TOC entry 221 (class 1259 OID 44088)
-- Name: thermochronology; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.thermochronology (
    id_analysis smallint NOT NULL,
    sample character varying NOT NULL,
    mineral character varying,
    method character varying,
    age real NOT NULL,
    "2sigma" real,
    method_comment text,
    age_comment text
);


ALTER TABLE public.thermochronology OWNER TO postgres;

--
-- TOC entry 4057 (class 0 OID 0)
-- Dependencies: 221
-- Name: TABLE thermochronology; Type: COMMENT; Schema: public; Owner: postgres
--

COMMENT ON TABLE public.thermochronology IS 'This table manage the samples and results for thermochronology dating';


--
-- TOC entry 3823 (class 2604 OID 42552)
-- Name: contacts id_contact; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.contacts ALTER COLUMN id_contact SET DEFAULT nextval('public.contacts_id_contacts_seq'::regclass);


--
-- TOC entry 3850 (class 2606 OID 42372)
-- Name: lexicon_contacts LEXICON_contact_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.lexicon_contacts
    ADD CONSTRAINT "LEXICON_contact_pkey" PRIMARY KEY (label);


--
-- TOC entry 3844 (class 2606 OID 42347)
-- Name: lexicon_outcrop LEXICON_outcrop_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.lexicon_outcrop
    ADD CONSTRAINT "LEXICON_outcrop_pkey" PRIMARY KEY (label);


--
-- TOC entry 3848 (class 2606 OID 42364)
-- Name: lexicon_samples LEXICON_sample_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.lexicon_samples
    ADD CONSTRAINT "LEXICON_sample_pkey" PRIMARY KEY (label);


--
-- TOC entry 3852 (class 2606 OID 42388)
-- Name: lexicon_sections LEXICON_sections_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.lexicon_sections
    ADD CONSTRAINT "LEXICON_sections_pkey" PRIMARY KEY (label);


--
-- TOC entry 3846 (class 2606 OID 42356)
-- Name: lexicon_sens_criteria LEXICON_sens_criteria_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.lexicon_sens_criteria
    ADD CONSTRAINT "LEXICON_sens_criteria_pkey" PRIMARY KEY (label);


--
-- TOC entry 3836 (class 2606 OID 41106)
-- Name: lexicon_lines Lines_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.lexicon_lines
    ADD CONSTRAINT "Lines_pkey" PRIMARY KEY (label);


--
-- TOC entry 3860 (class 2606 OID 44095)
-- Name: thermochronology Thermochronology_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.thermochronology
    ADD CONSTRAINT "Thermochronology_pkey" PRIMARY KEY (id_analysis);


--
-- TOC entry 3854 (class 2606 OID 42557)
-- Name: contacts contacts_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.contacts
    ADD CONSTRAINT contacts_pkey PRIMARY KEY (id_contact);


--
-- TOC entry 3886 (class 2606 OID 44898)
-- Name: fluid_inclusions fluid_inclusions_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.fluid_inclusions
    ADD CONSTRAINT fluid_inclusions_pkey PRIMARY KEY (id_analysis);


--
-- TOC entry 3840 (class 2606 OID 41170)
-- Name: formations formations_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.formations
    ADD CONSTRAINT formations_pkey PRIMARY KEY (id_formations);


--
-- TOC entry 3884 (class 2606 OID 44757)
-- Name: geologists geologists_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.geologists
    ADD CONSTRAINT geologists_pkey PRIMARY KEY (id_geologists);


--
-- TOC entry 3858 (class 2606 OID 43643)
-- Name: maps maps_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.maps
    ADD CONSTRAINT maps_pkey PRIMARY KEY (id_map);


--
-- TOC entry 3873 (class 2606 OID 44406)
-- Name: measures measures_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.measures
    ADD CONSTRAINT measures_pkey PRIMARY KEY (id_measure);


--
-- TOC entry 3838 (class 2606 OID 41130)
-- Name: missions mission_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.missions
    ADD CONSTRAINT mission_pkey PRIMARY KEY (mission);


--
-- TOC entry 3834 (class 2606 OID 41098)
-- Name: lexicon_planes planes_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.lexicon_planes
    ADD CONSTRAINT planes_pkey PRIMARY KEY (label);


--
-- TOC entry 3865 (class 2606 OID 44103)
-- Name: samples samples_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.samples
    ADD CONSTRAINT samples_pkey PRIMARY KEY (id_sample);


--
-- TOC entry 3882 (class 2606 OID 44654)
-- Name: sections sections_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sections
    ADD CONSTRAINT sections_pkey PRIMARY KEY (id_section);


--
-- TOC entry 3878 (class 2606 OID 44474)
-- Name: stations stations_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.stations
    ADD CONSTRAINT stations_pkey PRIMARY KEY (id_station);


--
-- TOC entry 3842 (class 2606 OID 41375)
-- Name: datations_bibliography thermochronology_bib_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.datations_bibliography
    ADD CONSTRAINT thermochronology_bib_pkey PRIMARY KEY (id);


--
-- TOC entry 3855 (class 1259 OID 43872)
-- Name: fki_contacts_fk; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX fki_contacts_fk ON public.contacts USING btree (type);


--
-- TOC entry 3856 (class 1259 OID 43800)
-- Name: fki_formation_fk; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX fki_formation_fk ON public.contacts USING btree (formation);


--
-- TOC entry 3866 (class 1259 OID 44407)
-- Name: fki_formations_fk; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX fki_formations_fk ON public.measures USING btree (formation);


--
-- TOC entry 3867 (class 1259 OID 44763)
-- Name: fki_geologist_fk; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX fki_geologist_fk ON public.measures USING btree (geologist);


--
-- TOC entry 3868 (class 1259 OID 44408)
-- Name: fki_lines_fk; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX fki_lines_fk ON public.measures USING btree (line_type);


--
-- TOC entry 3874 (class 1259 OID 44490)
-- Name: fki_maps_fk; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX fki_maps_fk ON public.stations USING btree (geol_map);


--
-- TOC entry 3861 (class 1259 OID 44119)
-- Name: fki_measures_fk; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX fki_measures_fk ON public.samples USING btree (associated_measure_id);


--
-- TOC entry 3875 (class 1259 OID 44491)
-- Name: fki_mission_fk; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX fki_mission_fk ON public.stations USING btree (mission);


--
-- TOC entry 3876 (class 1259 OID 44492)
-- Name: fki_outcrop_fk; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX fki_outcrop_fk ON public.stations USING btree (outcrop_type);


--
-- TOC entry 3869 (class 1259 OID 44409)
-- Name: fki_planes_fk; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX fki_planes_fk ON public.measures USING btree (plane_type);


--
-- TOC entry 3862 (class 1259 OID 44120)
-- Name: fki_sample_type_fk; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX fki_sample_type_fk ON public.samples USING btree (type);


--
-- TOC entry 3879 (class 1259 OID 44665)
-- Name: fki_samples_fk; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX fki_samples_fk ON public.sections USING btree (sample);


--
-- TOC entry 3880 (class 1259 OID 44666)
-- Name: fki_section_type_fk; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX fki_section_type_fk ON public.sections USING btree (type);


--
-- TOC entry 3870 (class 1259 OID 44410)
-- Name: fki_sens_criteria_fk; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX fki_sens_criteria_fk ON public.measures USING btree (sens_criteria);


--
-- TOC entry 3863 (class 1259 OID 44121)
-- Name: fki_station_fk; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX fki_station_fk ON public.samples USING btree (station);


--
-- TOC entry 3871 (class 1259 OID 44411)
-- Name: fki_stations_fk; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX fki_stations_fk ON public.measures USING btree (station);


--
-- TOC entry 3889 (class 2606 OID 43867)
-- Name: contacts contacts_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.contacts
    ADD CONSTRAINT contacts_fk FOREIGN KEY (type) REFERENCES public.lexicon_contacts(label) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 3888 (class 2606 OID 43795)
-- Name: contacts formation_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.contacts
    ADD CONSTRAINT formation_fk FOREIGN KEY (formation) REFERENCES public.formations(id_formations) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 3896 (class 2606 OID 44886)
-- Name: measures formations_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.measures
    ADD CONSTRAINT formations_fk FOREIGN KEY (formation) REFERENCES public.formations(id_formations) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 3895 (class 2606 OID 44758)
-- Name: measures geologist_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.measures
    ADD CONSTRAINT geologist_fk FOREIGN KEY (geologist) REFERENCES public.geologists(id_geologists) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 3899 (class 2606 OID 44451)
-- Name: measures lines_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.measures
    ADD CONSTRAINT lines_fk FOREIGN KEY (line_type) REFERENCES public.lexicon_lines(label) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 3900 (class 2606 OID 44594)
-- Name: stations maps_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.stations
    ADD CONSTRAINT maps_fk FOREIGN KEY (geol_map) REFERENCES public.maps(id_map) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 3891 (class 2606 OID 44636)
-- Name: samples measures_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.samples
    ADD CONSTRAINT measures_fk FOREIGN KEY (associated_measure_id) REFERENCES public.measures(id_measure) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 3901 (class 2606 OID 44604)
-- Name: stations missions_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.stations
    ADD CONSTRAINT missions_fk FOREIGN KEY (mission) REFERENCES public.missions(mission) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 3902 (class 2606 OID 61145)
-- Name: stations outcrop_type_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.stations
    ADD CONSTRAINT outcrop_type_fk FOREIGN KEY (outcrop_type) REFERENCES public.lexicon_outcrop(label) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 3897 (class 2606 OID 44441)
-- Name: measures planes_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.measures
    ADD CONSTRAINT planes_fk FOREIGN KEY (plane_type) REFERENCES public.lexicon_planes(label) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 3893 (class 2606 OID 44109)
-- Name: samples sample_type_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.samples
    ADD CONSTRAINT sample_type_fk FOREIGN KEY (type) REFERENCES public.lexicon_samples(label) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 4058 (class 0 OID 0)
-- Dependencies: 3893
-- Name: CONSTRAINT sample_type_fk ON samples; Type: COMMENT; Schema: public; Owner: postgres
--

COMMENT ON CONSTRAINT sample_type_fk ON public.samples IS 'This key guarantees the appropriate lexicon for sample type definition';


--
-- TOC entry 3890 (class 2606 OID 44170)
-- Name: thermochronology samples_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.thermochronology
    ADD CONSTRAINT samples_fk FOREIGN KEY (sample) REFERENCES public.samples(id_sample) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 3903 (class 2606 OID 44655)
-- Name: sections samples_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sections
    ADD CONSTRAINT samples_fk FOREIGN KEY (sample) REFERENCES public.samples(id_sample) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 3905 (class 2606 OID 44899)
-- Name: fluid_inclusions samples_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.fluid_inclusions
    ADD CONSTRAINT samples_fk FOREIGN KEY (sample) REFERENCES public.samples(id_sample) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 3904 (class 2606 OID 44660)
-- Name: sections section_type_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sections
    ADD CONSTRAINT section_type_fk FOREIGN KEY (type) REFERENCES public.lexicon_sections(label) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 3898 (class 2606 OID 44446)
-- Name: measures sens_criteria_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.measures
    ADD CONSTRAINT sens_criteria_fk FOREIGN KEY (sens_criteria) REFERENCES public.lexicon_sens_criteria(label) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 3906 (class 2606 OID 44904)
-- Name: fluid_inclusions station_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.fluid_inclusions
    ADD CONSTRAINT station_fk FOREIGN KEY (station) REFERENCES public.stations(id_station) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 3894 (class 2606 OID 44630)
-- Name: measures stations_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.measures
    ADD CONSTRAINT stations_fk FOREIGN KEY (station) REFERENCES public.stations(id_station) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 3892 (class 2606 OID 44641)
-- Name: samples stations_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.samples
    ADD CONSTRAINT stations_fk FOREIGN KEY (station) REFERENCES public.stations(id_station) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 3887 (class 2606 OID 44673)
-- Name: contacts stations_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.contacts
    ADD CONSTRAINT stations_fk FOREIGN KEY (station) REFERENCES public.stations(id_station) ON UPDATE CASCADE ON DELETE CASCADE;


-- Completed on 2021-03-02 16:43:01

--
-- PostgreSQL database dump complete
--

