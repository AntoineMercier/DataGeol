if [Trend] = null  then null else
if [Line plunge] <> null then [Line plunge] else
if [Line trend] - ([Dip az]-90) < 0 and [Line trend] <> null then Number.Abs(180/Number.PI*(Number.Atan(Number.Sin(((([Line trend]+180)-([Dip az]-90))))*Number.PI/180)*Number.Tan([Plane dip]*Number.PI/180))) else
if [Line trend] - ([Dip az]-90) > 0 and [Line trend] <> null then Number.Abs(180/Number.PI*(Number.Atan(Number.Sin((([Line trend]-([Dip az]-90))))*Number.PI/180)*Number.Tan([Plane dip]*Number.PI/180))) else 
if [Rake]="" then "" else 180/Number.PI*(Number.Asin((Number.Sin([Dip]*PI()/180))*(Number.Sin([Rake]*Number.PI/180)))))))))))